WARNING:tensorflow:From A:\SCMA\3-APD\fromAraya\faceRecog1\faceRecog\.venv\Lib\site-packages\tf_keras\src\losses.py:2976: The name tf.losses.sparse_softmax_cross_entropy is deprecated. Please use tf.compat.v1.losses.sparse_softmax_cross_entropy instead.

2026-01-22 15:37:45,274 - face_recog_modular2.tracking.progressive_mask_detector - INFO - Enhanced Progressive Mask Detector initialized
2026-01-22 15:37:45,274 - face_recog_modular2.tracking.progressive_mask_detector - INFO -   State holding duration: 15.0s
2026-01-22 15:37:45,274 - face_recog_modular2.tracking.progressive_mask_detector - INFO -   Minimum stability to commit: 0.15
2026-01-22 15:37:45,274 - face_recog_modular2.tracking.progressive_mask_detector - INFO -   Adaptive label weighting enabled
2026-01-22 15:37:45,274 - face_recog_modular2.tracking.tracking_manager - INFO - Policy Thresholds - min_violation_frames: 1, min_violation_duration: 1s
2026-01-22 15:37:45,274 - face_recog_modular2.tracking.tracking_manager - INFO - Simplified TrackingManager initialized

============================================================
≡ƒûÑ∩╕Å  SYSTEM INFORMATION
============================================================
≡ƒÆ╗ CPU Cores: 12
≡ƒÆ╛ Total RAM: 7.4 GB
≡ƒÄ« GPU: No CUDA devices available
≡ƒÉì Python Version: 3.12.1
≡ƒöÑ PyTorch Version: 2.9.1+cpu
≡ƒæü∩╕Å  OpenCV Version: 4.13.0
≡ƒöº ONNX Runtime Version: 1.23.2
============================================================

≡ƒöì Checking GPU availability...
ΓÜá∩╕Å  CUDA not available, falling back to CPU
≡ƒöº Available ONNX Providers: ['AzureExecutionProvider', 'CPUExecutionProvider']
ΓÜá∩╕Å  ONNX CUDA Execution Provider not available
≡ƒöä Using default multi-source configuration

≡ƒÄ» MULTI-SOURCE CONFIGURATION
==================================================
≡ƒô╣ 5:
   URL: 0
   Description: Main Camera
   Priority: medium
   CCTV Name: None
   Processing Scale: 1
==================================================

≡ƒöì Testing multi-stream connections for 1 sources...

≡ƒô╣ Testing source: 5
≡ƒÄ¼ StreamManager initialized with robust reconnection handling
≡ƒöì Initializing camera stream: 0
≡ƒô╖ Attempting to open camera 0 with backend 700
Γ£à Camera 0 opened successfully
Γ¥ñ∩╕Å  Stream health monitor started
≡ƒôè Stream Info:
   Type: camera
   Resolution: 640x480
   FPS: 30.0
   Source: 0
Γ£à Stream initialized successfully: 0
   Γ£à Frame 1: (480, 640, 3)
   Γ£à Frame 2: (480, 640, 3)
   Γ£à Frame 3: (480, 640, 3)
Γ£à Source 5 test successful
≡ƒö┤ Releasing StreamManager...
≡ƒö┤ StreamManager released

≡ƒôè STREAM TEST SUMMARY:
   Γ£à Successful: 1 sources
   Γ¥î Failed: 0 sources
≡ƒö┤ Releasing StreamManager...
≡ƒö┤ StreamManager released

≡ƒöä Creating face recognition system...
Γ£à ConfigManager initialized with unified configuration system
ΓÜá∩╕Å  Config for 'robust' not found, using base config

≡ƒöì Verifying GPU usage...
≡ƒÄ» YOLO Model Device: cpu
≡ƒÄ» ONNX Mask Detector Providers: ['CPUExecutionProvider']
≡ƒÄ» DeepFace Backend: Could not determine
≡ƒÄ» PerformanceManager initialized with momentum-based historical scaling
   - Scale range: 0.50 to 3.00
   - Cooldown range: 2.0s to 10.0s
ΓÜÖ∩╕Å BaseProcessor initialized with mandatory performance-managed scaling
≡ƒÄ» Initial scale: 1.00 (from PerformanceManager)
≡ƒÄ» PerformanceManager initialized with momentum-based historical scaling
   - Scale range: 0.50 to 3.00
   - Cooldown range: 2.0s to 10.0s
≡ƒöè Duration-aware batch alerts: 1 frames threshold
   Batch logic: window=5s, min=2
≡ƒÄ» MultiSourceRealTimeProcessor initialized with enhanced thread safety
≡ƒöè Alert config updated with batch logic
   Batch: window=5s, min=2
   Names: max=4
≡ƒöè Audio alert system configured
≡ƒÄ» Face tracking system configured for all sources
≡ƒôñ Server push configured for 0 sources
≡ƒôè Multi-source logging system configured
Γ£à Violation verification configured: enabled=True

============================================================
≡ƒÄ» MULTI-SOURCE SYSTEM CONFIGURATION STATUS
============================================================
≡ƒôè Sources: 1 cameras configured
≡ƒöì Detection: Confidence=0.5, Recognition Threshold=0.8
≡ƒÄ» Face Tracking: ENABLED
Γ£à Violation Verification: ENABLED
   - Min Duration: 1s
   - Min Frames: 1
   - Confidence Threshold: 0.15
≡ƒô¥ Logging: ENABLED
≡ƒöè Alerts: ENABLED
≡ƒôñ Server Push: ENABLED
≡ƒÉ¢ Debug: DISABLED
≡ƒû╝∩╕Å  Display Layout: grid
≡ƒÄ« GPU Acceleration: DISABLED
============================================================

≡ƒôñ SERVER PUSH CONFIGURATION
========================================
   Endpoint: https://vps.scasda.my.id/accounting/public/api/submit_ai_detection
   Cooldown: 5s
   Timeout: 10s
   Retry Attempts: 10
   CCTV Name: Default
   JSON Structure:
     {
       "filename": "string",
       "image_format": "jpg",
       "image_data": "base64_string",
       "detected_name": "string",
       "cctv_name": "string"
     }
========================================

==================================================
≡ƒæñ MULTI-SOURCE TRACKING SYSTEM STATUS
==================================================
==================================================

==================================================
≡ƒöè AUDIO ALERT SYSTEM STATUS
==================================================
  enabled: True
  server_url: https://vps.casda.my.id/actions/a_notifikasi_suara_speaker.php
  cooldown_seconds: 15
  min_violation_frames: 1
  min_violation_seconds: 1
  max_gap_frames: 10
  alert_language: id
  alert_style: formal
  alert_timeout_seconds: 2
  max_names_in_alert: 4
  batch_window_seconds: 5
  min_batch_size: 2
  image_log_interval: 5
  min_save_interval: 1.0
  current_batch_size: 0
  batch_violators: []
==================================================
≡ƒû╝∩╕Å  Display size set to 1280x720 using fit_to_screen method

≡ƒöì FINAL SYSTEM READINESS CHECK
========================================
≡ƒô╣ Sources: 1 cameras ready
   - 5
≡ƒÄ« GPU: CPU MODE
≡ƒôñ Server Push: READY
≡ƒöè Audio Alerts: READY
≡ƒÄ» Tracking: READY
Γ£à Violation Verification: READY
========================================

≡ƒÄ« VERIFICATION CONTROLS:
   [V] - Toggle violation verification
   [S] - Show verification statistics
   [M] - Start verification monitoring

≡ƒÄ« MULTI-SOURCE CONTROLS:
   [m] - Cycle through display layouts (grid, horizontal, vertical)
   [n] - Toggle source health display
   [0] - Show source health report
   [l] - Toggle logging
   [v] - Toggle voice alerts
   [p] - Toggle performance stats
   [d] - Toggle debug mode
   [q] - Quit

ΓÅ│ Starting multi-source processing in 3 seconds...

≡ƒöì ENSURING IMAGE LOGGERS ARE CREATED FOR ALL SOURCES

≡ƒöì PRE-START CCTV NAME CHECK

≡ƒöì DEBUG CCTV NAME STATUS
==================================================
Active sources: []
Source configs: []
Image loggers: []
==================================================

≡ƒÄ» ADDING SOURCES WITH DYNAMIC CCTV NAMING
==================================================
≡ƒô╣ Adding source: 5
   ≡ƒöì CCTV name extraction test: Camera-0
≡ƒôü Stored configuration for 5
≡ƒöì Final config keys for 5: ['url', 'description', 'priority', 'processing_scale', 'buffer_size', 'cctv_name', 'detection_model_path', 'embeddings_db_path', 'mask_model_path', 'detection_confidence', 'recognition_threshold', 'mask_detection_threshold', 'detection_iou', 'min_face_size', 'max_faces_per_frame', 'enable_person_detection', 'person_detection_confidence_threshold', 'display_layout', 'max_display_sources', 'processing_width', 'processing_height', 'maintenance_interval', 'violation_verification_enabled', 'min_violation_duration', 'min_violation_frames', 'violation_confidence_threshold', 'log_interval', 'enable_logging', 'enable_image_logging', 'image_log_interval', 'max_images_per_session', 'min_save_interval', 'server_push_enabled', 'server_endpoint', 'server_push_cooldown', 'server_timeout', 'server_retry_attempts', 'server_retry_delay', 'enable_image_resize', 'image_resize_width', 'image_resize_height', 'image_resize_method', 'enable_voice_alerts', 'alert_server_url', 'alert_cooldown_seconds', 'min_violation_seconds', 'max_gap_frames', 'alert_language', 'alert_style', 'enable_individual_alerts', 'enable_group_alerts', 'alert_timeout_seconds', 'alert_verification_required', 'min_alert_confidence', 'alert_buffer_size', 'enable_multi_scale', 'enable_temporal_fusion', 'enable_quality_aware', 'embedding_model', 'enable_base64_logging', 'base64_quality', 'headless_mode', 'use_gpu', 'gpu_device', 'annotation_box_thickness', 'annotation_text_thickness', 'annotation_min_text_scale', 'annotation_max_text_scale']
≡ƒÄ¼ StreamManager initialized with robust reconnection handling
≡ƒöì Initializing camera stream: 0
≡ƒô╖ Attempting to open camera 0 with backend 700
Γ£à Camera 0 opened successfully
Γ¥ñ∩╕Å  Stream health monitor started
≡ƒôè Stream Info:
   Type: camera
   Resolution: 640x480
   FPS: 30.0
   Source: 0
Γ£à Stream initialized successfully: 0
≡ƒîÉ Global tracking config available: True
